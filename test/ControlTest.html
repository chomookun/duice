<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <script src="../dist/duice.js"></script>
    <link rel="stylesheet" href="../dist/duice.css">
    <script>
        'use strict';
        let myObject = new duice.ObjectProxy({
            name: 'Apple',
            phoneNo: '01012345678',
            cardNo: '0000111122223333',
            balanceAmount: 1234567.13,
            password: 'p1a2s3s4w5o6r7d8!@',
            datetime: '2019-03-16T18:00',
            date: '2019-04-01',
            time: '18:12',
            type: 'human',
            enabled: true,
            enabledYn: 'Y',
            gender: 'male',
            description: "My name is apple.\n I am Fruit.",
            address: {
                country: 'USA',
                city: 'LA'
            },
            items: [
                {id:'a', name:'A'},
                {id:'b', name:'B'},
                {id:'c', name:'C'}
            ]
        });

        /**
         * viewMyObject
         */
        function viewMyObject() {
            document.getElementById('myObject').value = JSON.stringify(myObject, null, 4);
        }

        /**
         * assignMyObject
         */
        function assignMyObject() {
            let object = JSON.parse(document.getElementById('myObject').value);
            duice.ObjectProxy.assign(myObject, object);
        }

        // adds before change listener
        duice.ObjectProxy.onPropertyChanging(myObject, async (event) => {
            if(await duice.confirm(`Do you want to change [${event.getProperty()}] is [${event.getValue()}]`)){
                return true;
            }else{
                return false;
            }
        });

        // adds after change listener
        duice.ObjectProxy.onPropertyChanged(myObject, (property, value) => {
            viewMyObject();
        });

        // adds DOMContentLoaded event listener
        document.addEventListener("DOMContentLoaded", event => {
            viewMyObject();
            document.getElementById("myObject").addEventListener('change',()=>{
                assignMyObject();
            });
        });

    </script>
</head>
<body>
<h1>Element Test</h1>
<div class="container">
    <div class="row">
        <div class="col-3">
            <h2>ObjectProxy</h2>
            <textarea id="myObject" rows="20" class="fw-light" >
            </textarea>
            <div style="display:flex; flex-direction:column; align-items:flex-start;">
                <button onclick="assignMyObject();" class="fw-light">
                    duice.ObjectProxy.assign(myObject,[object]);
                </button>
                <button onclick="duice.ObjectProxy.setReadonlyAll(myObject, true);" class="fw-light">
                    duice.ObjectProxy.setReadonlyAll(myObject,true);
                </button>
                <button onclick="duice.ObjectProxy.setReadonlyAll(myObject, false);" class="fw-light">
                    duice.ObjectProxy.setReadonlyAll(myObject,false);
                </button>
                <button onclick="duice.ObjectProxy.setReadonly(myObject, 'name', true);" class="fw-light">
                    duice.ObjectProxy.setReadonly(myObject,'name', true);
                </button>
                <button onclick="duice.ObjectProxy.setReadonly(myObject, 'name', false);" class="fw-light">
                    duice.ObjectProxy.setReadonly(myObject,'name', false);
                </button>
            </div>
        </div>
        <div class="col-9">
            <h2>Element</h2>
            <table class="table table-bordered">
                <thead>
                <tr>
                    <th>Property</th>
                    <th>Value</th>
                    <th>Element</th>
                    <th>HTML Code</th>
                </tr>
                </thead>
                <!-- name -->
                <tbody>
                <tr>
                    <td rowspan="2" class="fw-bold">name</td>
                    <td rowspan="2" dc:object="myObject" dc:property="name"></td>
                    <td>
                        <span dc:object="myObject" dc:property="name"/></span>
                    </td>
                    <td class="fw-light">
                        &lt;* dc:object="myObject" dc:property="name"&gt; &lt;/*&gt;
                    </td>
                </tr>
                <tr>
                    <td>
                        <input type="text" dc:object="myObject" dc:property="name"/>
                    </td>
                    <td class="fw-light">
                        &lt;input type="text" dc:object="myObject" dc:property="name"/&gt;
                    </td>
                </tr>
                </tbody>
                <!-- phoneNo -->
                <tbody>
                <tr>
                    <td rowspan="4" class="fw-bold">phoneNo</td>
                    <td rowspan="4" dc:object="myObject" dc:property="phoneNo"></td>
                    <td>
                        <span dc:object="myObject" dc:property="phoneNo"/></span>
                    </td>
                    <td class="fw-light">
                        &lt;* dc:object="myObject" dc:property="phoneNo"&gt; &lt;/*&gt;
                    </td>
                </tr>
                <tr>
                    <td dc:object="myObject" dc:property="phoneNo" dc:mask="string('###-####-####')"></td>
                    <td class="fw-light">
                        &lt;* dc:object="myObject" dc:property="phoneNo" dc:mask="string('###-####-####')"&gt; &lt;/*&gt;
                    </td>
                </tr>
                <tr>
                    <td>
                        <input type="text" dc:object="myObject" dc:property="phoneNo"/>
                    </td>
                    <td class="fw-light">
                        &lt;input type="text" dc:object="myObject" dc:property="phoneNo"/&gt;
                    </td>
                </tr>
                <tr>
                    <td>
                        <input type="text" dc:object="myObject" dc:property="phoneNo" dc:mask="string('###-####-####')"/>
                    </td>
                    <td class="fw-light">
                        &lt;input type="text" dc:object="myObject" dc:property="phoneNo" dc:mask="string('###-####-####')"/&gt;
                    </td>
                </tr>
                </tbody>
                <!-- cardNo -->
                <tbody>
                <tr>
                    <td rowspan="4" class="fw-bold">cardNo</td>
                    <td rowspan="4" dc:object="myObject" dc:property="cardNo"></td>
                    <td>
                        <span dc:object="myObject" dc:property="cardNo"/></span>
                    </td>
                    <td class="fw-light">
                        &lt;* dc:object="myObject" dc:property="cardNo"&gt; &lt;/*&gt;
                    </td>
                </tr>
                <tr>
                    <td dc:object="myObject" dc:property="cardNo" dc:mask="string('####-####-####-####')"></td>
                    <td class="fw-light">
                        &lt;* dc:object="myObject" dc:property="cardNo" dc:mask="string('####-####-####-####')"&gt; &lt;/*&gt;
                    </td>
                </tr>
                <tr>
                    <td>
                        <input type="text" dc:object="myObject" dc:property="cardNo"/>
                    </td>
                    <td class="fw-light">
                        &lt;input type="text" dc:object="myObject" dc:property="cardNo"/&gt;
                    </td>
                </tr>
                <tr>
                    <td>
                        <input type="text" dc:object="myObject" dc:property="cardNo" dc:mask="string('####-####-####-####')"/>
                    </td>
                    <td class="fw-light">
                        &lt;input type="text" dc:object="myObject" dc:property="cardNo" dc:mask="string('####-####-####-####')"/&gt;
                    </td>
                </tr>
                </tbody>
                <!-- balanceAmount -->
                <tbody>
                <tr>
                    <td rowspan="4" class="fw-bold">balanceAmount</td>
                    <td rowspan="4" dc:object="myObject" dc:property="balanceAmount"></td>
                    <td>
                        <span dc:object="myObject" dc:property="balanceAmount"></span>
                    </td>
                    <td class="fw-light">
                        &lt;* dc:object="myObject" dc:property="balanceAmount"&gt; &lt;/*&gt;
                    </td>
                </tr>
                <tr>
                    <td type="number" dc:object="myObject" dc:property="balanceAmount" dc:mask="number(2)"></td>
                    <td class="fw-light">
                        &lt;* dc:object="myObject" dc:property="balanceAmount" dc:mask="number(2)"&gt &lt;/*&gt;
                    </td>
                </tr>
                <tr>
                    <td>
                        <input type="number" dc:object="myObject" dc:property="balanceAmount"/>
                    </td>
                    <td class="fw-light">
                        &lt;input type="number" dc:object="myObject" dc:property="balanceAmount"/&gt;
                    </td>
                </tr>
                <tr>
                    <td>
                        <input type="number" dc:object="myObject" dc:property="balanceAmount" dc:mask="number(2)"/>
                    </td>
                    <td class="fw-light">
                        &lt;input type="number" dc:object="myObject" dc:property="balanceAmount" dc:mask="number(2)"/&gt;
                    </td>
                </tr>
                <!-- password -->
                <tbody>
                <tr>
                    <td class="fw-bold">password</td>
                    <td dc:object="myObject" dc:property="password"></td>
                    <td>
                        <input type="password" dc:object="myObject" dc:property="password"></input>
                    </td>
                    <td class="fw-light">
                        &lt;input type="password" dc:object="myObject" dc:property="password"&gt; &lt;/*&gt;
                    </td>
                </tr>
                </tbody>
                <!-- datetime -->
                <tbody>
                <tr>
                    <td rowspan="2" class="fw-bold">datetime</td>
                    <td rowspan="2" dc:object="myObject" dc:property="datetime"></td>
                    <td>
                        <span dc:object="myObject" dc:property="datetime" dc:mask="date('yyyy-MM-dd HH:mm:ss')"></span>
                    </td>
                    <td class="fw-light">
                        &lt;* dc:object="myObject" dc:property="datetime" dc:mask="date('yyyy-MM-dd HH:mm:ss')"&gt; &lt;/*&gt;
                    </td>
                </tr>
                <tr>
                    <td>
                        <input type="datetime-local" dc:object="myObject" dc:property="datetime"/>
                    </td>
                    <td class="fw-light">
                        &lt;input type="datetime-local" dc:object="myObject" dc:property="datetime"/&gt;
                    </td>
                </tr>
                </tbody>
                <!-- date -->
                <tbody>
                <tr>
                    <td rowspan="2" class="fw-bold">date</td>
                    <td rowspan="2" dc:object="myObject" dc:property="date"></td>
                    <td>
                        <span dc:object="myObject" dc:property="date" dc:mask="date('yyyy-MM-dd')"></span>
                    </td>
                    <td class="fw-light">
                        &lt;* dc:object="myObject" dc:property="date" dc:mask="date('yyyy-MM-dd HH:mm:ss')"&gt; &lt;/*&gt;
                    </td>
                </tr>
                <tr>
                    <td>
                        <input type="date" dc:object="myObject" dc:property="date"/>
                    </td>
                    <td class="fw-light">
                        &lt;input type="date" dc:object="myObject" dc:property="date"/&gt;
                    </td>
                </tr>
                </tbody>
                <!-- time -->
                <tbody>
                <tr>
                    <td rowspan="2" class="fw-bold">time</td>
                    <td rowspan="2" dc:object="myObject" dc:property="time"></td>
                    <td>
                        <span dc:object="myObject" dc:property="time"></span>
                    </td>
                    <td class="fw-light">
                        &lt;* dc:object="myObject" dc:property="time"&gt; &lt;/*&gt;
                    </td>
                </tr>
                <tr>
                    <td>
                        <input type="time" dc:object="myObject" dc:property="time"/>
                    </td>
                    <td class="fw-light">
                        &lt;input type="time" dc:object="myObject" dc:property="time"/&gt;
                    </td>
                </tr>
                </tbody>
                <!-- type -->
                <tbody>
                <tr>
                    <td rowspan="2" class="fw-bold">type</td>
                    <td rowspan="2" dc:object="myObject" dc:property="type"></td>
                    <td>
                        <span dc:object="myObject" dc:property="type"></span>
                    </td>
                    <td class="fw-light">
                        &lt;* dc:object="myObject" dc:property="type"&gt; &lt;/*&gt;
                    </td>
                </tr>
                <tr>
                    <td>
                        <select dc:object="myObject" dc:property="type">
                            <option value>- Select Type -</option>
                            <option value="human">Human</option>
                            <option value="fruit">Fruit</option>
                            <option value="animal">Animal</option>
                        </select>
                    </td>
                    <td class="fw-light">
                        &lt;select dc:object="myObject" dc:property="type"/&gt; ... &lt;/select&gt;
                    </td>
                </tr>
                </tbody>
                <!-- enabled -->
                <tbody>
                <tr>
                    <td rowspan="2" class="fw-bold">enable</td>
                    <td rowspan="2" dc:object="myObject" dc:property="enabled"></td>
                    <td>
                        <span dc:object="myObject" dc:property="enabled"></span>
                    </td>
                    <td class="fw-light">
                        &lt;* dc:object="myObject" dc:property="enabled"&gt; &lt;/*&gt;
                    </td>
                </tr>
                <tr>
                    <td>
                        <input type="checkbox" dc:object="myObject" dc:property="enabled"/>
                    </td>
                    <td class="fw-light">
                        &lt;input type="checkbox" dc:object="myObject" dc:property="enabled"/&gt;
                    </td>
                </tr>
                </tbody>
                <!-- enabledYn -->
                <tbody>
                <tr>
                    <td rowspan="2" class="fw-bold">enableYn</td>
                    <td rowspan="2" dc:object="myObject" dc:property="enabledYn"></td>
                    <td>
                        <span dc:object="myObject" dc:property="enabledYn"></span>
                    </td>
                    <td class="fw-light">
                        &lt;* dc:object="myObject" dc:property="enabledYn"&gt; &lt;/*&gt;
                    </td>
                </tr>
                <tr>
                    <td>
                        <input type="checkbox" dc:object="myObject" dc:property="enabledYn" dc:true-value="Y" dc:false-value="N"/>
                    </td>
                    <td class="fw-light">
                        &lt;input type="checkbox" dc:object="myObject" dc:property="enabled" dc:true-value="Y" dc:false-value="N"/&gt;
                    </td>
                </tr>
                </tbody>
                <!-- gender -->
                <tbody>
                <tr>
                    <td rowspan="2" class="fw-bold">gender</td>
                    <td rowspan="2" dc:object="myObject" dc:property="gender"></td>
                    <td>
                        <span dc:object="myObject" dc:property="gender"></span>
                    </td>
                    <td class="fw-light">
                        &lt;* dc:object="myObject" dc:property="enabledYn"&gt; &lt;/*&gt;
                    </td>
                </tr>
                <tr>
                    <td>
                        <input type="radio" dc:object="myObject" dc:property="gender" value="male"/>
                        <input type="radio" dc:object="myObject" dc:property="gender" value="female"/>
                    </td>
                    <td class="fw-light">
                        &lt;input type="radio" dc:object="myObject" dc:property="gender" value="male"/&gt;
                        <br/>
                        &lt;input type="radio" dc:object="myObject" dc:property="gender" value="female"/&gt;
                    </td>
                </tr>
                </tbody>
                <!-- description -->
                <tbody>
                <tr>
                    <td rowspan="2" class="fw-bold">description</td>
                    <td rowspan="2" dc:object="myObject" dc:property="description" style="white-space: pre-wrap;"></td>
                    <td>
                        <pre dc:object="myObject" dc:property="description"></pre>
                    </td>
                    <td class="fw-light">
                        &lt;* dc:object="myObject" dc:property="description"&gt; &lt;/*&gt;
                    </td>
                </tr>
                <tr>
                    <td>
                        <textarea dc:object="myObject" dc:property="description"/></textarea>
                    </td>
                    <td class="fw-light">
                        &lt;textarea dc:object="myObject" dc:property="description"&gt; &lt;/textarea&gt;
                    </td>
                </tr>
                </tbody>
                <!-- address.country -->
                <tbody>
                <tr>
                    <td rowspan="2" class="fw-bold">address.country</td>
                    <td rowspan="2" dc:object="myObject" dc:property="address.country"></td>
                    <td>
                        <span dc:object="myObject" dc:property="address.country"></span>
                    </td>
                    <td class="fw-light">
                        &lt;* dc:object="myObject" dc:property="address.country"&gt; &lt;/*&gt;
                    </td>
                </tr>
                <tr>
                    <td>
                        <input type="text" dc:object="myObject" dc:property="address.country"/>
                    </td>
                    <td class="fw-light">
                        &lt;input type="text" dc:object="myObject" dc:property="address.country"/&gt;
                    </td>
                </tr>
                </tbody>
                <!-- items -->
                <tbody>
                <tr>
                    <td rowspan="2" class="fw-bold">items[0].name</td>
                    <td rowspan="2" dc:object="myObject" dc:property="items[0].name"></td>
                    <td>
                        <span dc:object="myObject" dc:property="items[0].name"></span>
                    </td>
                    <td class="fw-light">
                        &lt;* dc:object="myObject" dc:property="items[0].name"&gt; &lt;/*&gt;
                    </td>
                </tr>
                <tr>
                    <td>
                        <input type="text" dc:object="myObject" dc:property="items[0].name"/>
                    </td>
                    <td class="fw-light">
                        &lt;input type="text" dc:object="myObject" dc:property="items[0].name"/&gt;
                    </td>
                </tr>
                </tbody>
                <!-- items[] -->
                <tbody>
                <tr>
                    <td rowspan="2" class="fw-bold">items</td>
                    <td rowspan="2" dc:object="myObject" dc:script="this.innerHTML=JSON.stringify(myObject.items,null,4);" style="white-space:pre;text-align:left;"></td>
                    <td>
                        <table>
                            <tr>
                                <th>id</th>
                                <th>name</th>
                            </tr>
                            <tr dc:array="myObject.items" dc:loop="item,status">
                                <td>
                                    <input type="text" dc:object="item" dc:property="id">
                                </td>
                                <td>
                                    <input type="text" dc:object="item" dc:property="name">
                                </td>
                            </tr>
                        </table>
                    </td>
                    <td class="fw-light ta-left" style="white-space:pre;">
&lt;tr dc:array="myObject.items" dc:loop="item,status"&gt;
    &lt;td&gt;
        &lt;input type="text" dc:object="item" dc:property="id"&gt;
    &lt;/td&gt;
    &lt;td&gt;
        &lt;input type="text" dc:object="item" dc:property="name"&gt;
    &lt;/td&gt;
&lt;/tr&gt;
                    </td>
                </tr>
                </tbody>
            </table>
        </div>
    </div>
</div>
</body>
</html>