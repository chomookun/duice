<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <script src="../dist/duice.js"></script>
    <link rel="stylesheet" href="../dist/duice.css">
<!--    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.1.3/dist/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">-->
    <script>
        'use strict';
        let myObject = new duice.ObjectProxy({
            name: 'Apple',
            phoneNo: '01012345678',
            cardNo: '0000111122223333',
            balanceAmount: 1234567.13,
            type: 'human',
            enabled: true,
            enabledYn: 'Y',
            description: "My name is apple.\n I am Fruit.",
            address: {
                country: 'USA',
                city: 'LA'
            },
            items: [
                {id:'a', name:'A'},
                {id:'b', name:'B'},
                {id:'c', name:'C'}
            ]
        });

        /**
         * viewMyObject
         */
        function viewMyObject() {
            document.getElementById('myObject').value = JSON.stringify(myObject, null, 4);
        }

        /**
         * assignMyObject
         */
        function assignMyObject() {
            let object = JSON.parse(document.getElementById('myObject').value);
            duice.ObjectProxy.assign(myObject, object);
        }
        //
        // // adds before change listener
        // duice.ObjectProxy.onPropertyChanging(myObject, async (event) => {
        //     if(await duice.confirm(`Do you want to change [${event.getProperty()}] is [${event.getValue()}]`)){
        //         return true;
        //     }else{
        //         return false;
        //     }
        // });
        //
        // // adds after change listener
        // duice.ObjectProxy.onPropertyChanged(myObject, (property, value) => {
        //     viewMyObject();
        // });

        // adds DOMContentLoaded event listener
        document.addEventListener("DOMContentLoaded", event => {
            viewMyObject();
            document.getElementById("myObject").addEventListener('change',()=>{
                assignMyObject();
            });
        });

    </script>
</head>
<body>
<h1>Element Test</h1>
<div class="container">
    <div class="row">
        <div class="col-3">
            <h2>Data</h2>
            <textarea id="myObject" rows="15" class="font-weight-light" >
            </textarea>
            <div style="display:flex; flex-direction:column; align-items:flex-start;">
                <button onclick="assignMyObject();" class="font-weight-light">
                    duice.ObjectProxy.assign(myObject,[object]);
                </button>
                <button onclick="duice.ObjectProxy.setReadonlyAll(myObject, true);" class="font-weight-light">
                    duice.ObjectProxy.setReadonlyAll(myObject,true);
                </button>
                <button onclick="duice.ObjectProxy.setReadonlyAll(myObject, false);" class="font-weight-light">
                    duice.ObjectProxy.setReadonlyAll(myObject,false);
                </button>
                <button onclick="duice.ObjectProxy.setReadonly(myObject, 'name', true);" class="font-weight-light">
                    duice.ObjectProxy.setReadonly(myObject,'name', true);
                </button>
                <button onclick="duice.ObjectProxy.setReadonly(myObject, 'name', false);" class="font-weight-light">
                    duice.ObjectProxy.setReadonly(myObject,'name',true);
                </button>
                <button onclick="alert(duice.ObjectProxy.isDirty(myObject));" class="font-weight-light">
                    duice.ObjectProxy.isDirty(myObject);
                </button>
                <button onclick="duice.ObjectProxy.reset(myObject); viewMyObject();" class="font-weight-light">
                    duice.ObjectProxy.reset(myObject);
                </button>
            </div>
        </div>
        <div class="col-9">
            <h2>Element</h2>
            <table class="table table-bordered">
                <thead>
                <tr>
                    <th>Property</th>
                    <th>Value</th>
                    <th>Element</th>
                    <th>HTML Code</th>
                </tr>
                </thead>
                <!-- name -->
                <tbody>
                <tr>
                    <td rowspan="2" class="font-weight-bold">name</td>
                    <td rowspan="2" duice:object="myObject" duice:property="name"></td>
                    <td>
                        <span duice:object="myObject" duice:property="name"/></span>
                    </td>
                    <td class="font-weight-light">
                        &lt;* duice:object="myObject" duice:property="name"&gt; &lt;/*&gt;
                    </td>
                </tr>
                <tr>
                    <td>
                        <input type="text" duice:object="myObject" duice:property="name"/>
                    </td>
                    <td class="font-weight-light">
                        &lt;input type="text" duice:object="myObject" duice:property="name"/&gt;
                    </td>
                </tr>
                </tbody>
                <!-- phoneNo -->
                <tbody>
                <tr>
                    <td rowspan="4" class="font-weight-bold">phoneNo</td>
                    <td rowspan="4" duice:object="myObject" duice:property="phoneNo"></td>
                    <td>
                        <span duice:object="myObject" duice:property="phoneNo"/></span>
                    </td>
                    <td class="font-weight-light">
                        &lt;* duice:object="myObject" duice:property="phoneNo"&gt; &lt;/*&gt;
                    </td>
                </tr>
                <tr>
                    <td duice:object="myObject" duice:property="phoneNo" duice:mask="string('###-####-####')"></td>
                    <td class="font-weight-light">
                        &lt;* duice:object="myObject" duice:property="phoneNo" duice:mask="string('###-####-####')"&gt; &lt;/*&gt;
                    </td>
                </tr>
                <tr>
                    <td>
                        <input type="text" duice:object="myObject" duice:property="phoneNo"/>
                    </td>
                    <td class="font-weight-light">
                        &lt;input type="text" duice:object="myObject" duice:property="phoneNo"/&gt;
                    </td>
                </tr>
                <tr>
                    <td>
                        <input type="text" duice:object="myObject" duice:property="phoneNo" duice:mask="string('###-####-####')"/>
                    </td>
                    <td class="font-weight-light">
                        &lt;input type="text" duice:object="myObject" duice:property="phoneNo" duice:mask="string('###-####-####')"/&gt;
                    </td>
                </tr>
                </tbody>
                <!-- cardNo -->
                <tbody>
                <tr>
                    <td rowspan="4" class="font-weight-bold">cardNo</td>
                    <td rowspan="4" duice:object="myObject" duice:property="cardNo"></td>
                    <td>
                        <span duice:object="myObject" duice:property="cardNo"/></span>
                    </td>
                    <td class="font-weight-light">
                        &lt;* duice:object="myObject" duice:property="cardNo"&gt; &lt;/*&gt;
                    </td>
                </tr>
                <tr>
                    <td duice:object="myObject" duice:property="cardNo" duice:mask="string('####-####-####-####')"></td>
                    <td class="font-weight-light">
                        &lt;* duice:object="myObject" duice:property="cardNo" duice:mask="string('####-####-####-####')"&gt; &lt;/*&gt;
                    </td>
                </tr>
                <tr>
                    <td>
                        <input type="text" duice:object="myObject" duice:property="cardNo"/>
                    </td>
                    <td class="font-weight-light">
                        &lt;input type="text" duice:object="myObject" duice:property="cardNo"/&gt;
                    </td>
                </tr>
                <tr>
                    <td>
                        <input type="text" duice:object="myObject" duice:property="cardNo" duice:mask="string('####-####-####-####')"/>
                    </td>
                    <td class="font-weight-light">
                        &lt;input type="text" duice:object="myObject" duice:property="cardNo" duice:mask="string('####-####-####-####')"/&gt;
                    </td>
                </tr>
                </tbody>
                <!-- balanceAmount -->
                <tbody>
                <tr>
                    <td rowspan="4" class="font-weight-bold">balanceAmount</td>
                    <td rowspan="4" duice:object="myObject" duice:property="balanceAmount"></td>
                    <td>
                        <span duice:object="myObject" duice:property="balanceAmount"></span>
                    </td>
                    <td class="font-weight-light">
                        &lt;* duice:object="myObject" duice:property="balanceAmount"&gt; &lt;/*&gt;
                    </td>
                </tr>
                <tr>
                    <td type="number" duice:object="myObject" duice:property="balanceAmount" duice:mask="number(2)"></td>
                    <td class="font-weight-light">
                        &lt;* duice:object="myObject" duice:property="balanceAmount" duice:mask="number(2)"&gt &lt;/*&gt;
                    </td>
                </tr>
                <tr>
                    <td>
                        <input type="number" duice:object="myObject" duice:property="balanceAmount"/>
                    </td>
                    <td class="font-weight-light">
                        &lt;input type="number" duice:object="myObject" duice:property="balanceAmount"/&gt;
                    </td>
                </tr>
                <tr>
                    <td>
                        <input type="number" duice:object="myObject" duice:property="balanceAmount" duice:mask="number(2)"/>
                    </td>
                    <td class="font-weight-light">
                        &lt;input type="number" duice:object="myObject" duice:property="balanceAmount" duice:mask="number(2)"/&gt;
                    </td>
                </tr>
                </tbody>
                <!-- type -->
                <tbody>
                <tr>
                    <td rowspan="2" class="font-weight-bold">type</td>
                    <td rowspan="2" duice:object="myObject" duice:property="type"></td>
                    <td>
                        <span duice:object="myObject" duice:property="type"></span>
                    </td>
                    <td class="font-weight-light">
                        &lt;* duice:object="myObject" duice:property="type"&gt; &lt;/*&gt;
                    </td>
                </tr>
                <tr>
                    <td>
                        <select duice:object="myObject" duice:property="type">
                            <option value>- Select Type -</option>
                            <option value="human">Human</option>
                            <option value="fruit">Fruit</option>
                            <option value="animal">Animal</option>
                        </select>
                    </td>
                    <td class="font-weight-light">
                        &lt;select duice:object="myObject" duice:property="type"/&gt; ... &lt;/select&gt;
                    </td>
                </tr>
                </tbody>
                <!-- enabled -->
                <tbody>
                <tr>
                    <td rowspan="2" class="font-weight-bold">enable</td>
                    <td rowspan="2" duice:object="myObject" duice:property="enabled"></td>
                    <td>
                        <span duice:object="myObject" duice:property="enabled"></span>
                    </td>
                    <td class="font-weight-light">
                        &lt;* duice:object="myObject" duice:property="enabled"&gt; &lt;/*&gt;
                    </td>
                </tr>
                <tr>
                    <td>
                        <input type="checkbox" duice:object="myObject" duice:property="enabled"/>
                    </td>
                    <td class="font-weight-light">
                        &lt;input type="checkbox" duice:object="myObject" duice:property="enabled"/&gt;
                    </td>
                </tr>
                </tbody>
                <!-- enabledYn -->
                <tbody>
                <tr>
                    <td rowspan="2" class="font-weight-bold">enableYn</td>
                    <td rowspan="2" duice:object="myObject" duice:property="enabledYn"></td>
                    <td>
                        <span duice:object="myObject" duice:property="enabledYn"></span>
                    </td>
                    <td class="font-weight-light">
                        &lt;* duice:object="myObject" duice:property="enabledYn"&gt; &lt;/*&gt;
                    </td>
                </tr>
                <tr>
                    <td>
                        <input type="checkbox" duice:object="myObject" duice:property="enabledYn" duice:true-value="Y" duice:false-value="N"/>
                    </td>
                    <td class="font-weight-light">
                        &lt;input type="checkbox" duice:object="myObject" duice:property="enabled" duice:true-value="Y" duice:false-value="N"/&gt;
                    </td>
                </tr>
                </tbody>
                <!-- description -->
                <tbody>
                <tr>
                    <td rowspan="2" class="font-weight-bold">description</td>
                    <td rowspan="2" duice:object="myObject" duice:property="description" style="white-space: pre-wrap;"></td>
                    <td>
                        <pre duice:object="myObject" duice:property="description"></pre>
                    </td>
                    <td class="font-weight-light">
                        &lt;* duice:object="myObject" duice:property="description"&gt; &lt;/*&gt;
                    </td>
                </tr>
                <tr>
                    <td>
                        <textarea duice:object="myObject" duice:property="description"/></textarea>
                    </td>
                    <td class="font-weight-light">
                        &lt;textarea duice:object="myObject" duice:property="description"&gt; &lt;/textarea&gt;
                    </td>
                </tr>
                </tbody>
                <!-- address.country -->
                <tbody>
                <tr>
                    <td rowspan="2" class="font-weight-bold">address.country</td>
                    <td rowspan="2" duice:object="myObject" duice:property="address.country"></td>
                    <td>
                        <span duice:object="myObject" duice:property="address.country"></span>
                    </td>
                    <td class="font-weight-light">
                        &lt;* duice:object="myObject" duice:property="address.country"&gt; &lt;/*&gt;
                    </td>
                </tr>
                <tr>
                    <td>
                        <input type="text" duice:object="myObject" duice:property="address.country"/>
                    </td>
                    <td class="font-weight-light">
                        &lt;input type="text" duice:object="myObject" duice:property="address.country"/&gt;
                    </td>
                </tr>
                </tbody>
                <!-- items -->
                <tbody>
                <tr>
                    <td rowspan="2" class="font-weight-bold">items[0].name</td>
                    <td rowspan="2" duice:object="myObject" duice:property="items[0].name"></td>
                    <td>
                        <span duice:object="myObject" duice:property="items[0].name"></span>
                    </td>
                    <td class="font-weight-light">
                        &lt;* duice:object="myObject" duice:property="items[0].name"&gt; &lt;/*&gt;
                    </td>
                </tr>
                <tr>
                    <td>
                        <input type="text" duice:object="myObject" duice:property="items[0].name"/>
                    </td>
                    <td class="font-weight-light">
                        &lt;input type="text" duice:object="myObject" duice:property="items[0].name"/&gt;
                    </td>
                </tr>
                </tbody>
                <!-- -->
                <tbody>
                <tr>
                    <td>
                        <ul>
                            <li duice:array="myObject.items" duice:loop="item,status">
                                <input type="text" duice:object="item" duice:property="name"/>
                            </li>
                        </ul>
                    </td>
                </tr>
                </tbody>
            </table>
        </div>
    </div>
</div>
</body>
</html>